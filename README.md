Tablas:
Compras:
[
  {
    "name": "idUsuario",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "idCompra",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "idProducto",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "nombreProducto",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "nombreProductoDisplay",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "tipoProducto",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "fechaCreacion",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "idPlanPago",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "nombrePlanPago",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "nombrePlanPagoDisplay",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "idFrecuencia",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "noDias",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "tipoPeriodo",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "nombreFrecuencia",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "precio",
    "mode": "NULLABLE",
    "type": "FLOAT",
    "description": "",
    "fields": []
  },
  {
    "name": "precioFinal",
    "mode": "NULLABLE",
    "type": "FLOAT",
    "description": "",
    "fields": []
  },
  {
    "name": "idMoneda",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "idDescuento",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "tipoDescuento",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "valorDescuento",
    "mode": "NULLABLE",
    "type": "FLOAT",
    "description": "",
    "fields": []
  },
  {
    "name": "codigosPromocion",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "cantidad",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "fechaInicioEntrega",
    "mode": "NULLABLE",
    "type": "DATETIME",
    "description": "",
    "fields": []
  },
  {
    "name": "fechaInicioSuscripcion",
    "mode": "NULLABLE",
    "type": "DATETIME",
    "description": "",
    "fields": []
  },
  {
    "name": "fechaFinalSuscripcion",
    "mode": "NULLABLE",
    "type": "DATETIME",
    "description": "",
    "fields": []
  },
  {
    "name": "tipoPago",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "tipoOrden",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "marca",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "canal",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "estado",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "ultimaFechaPago",
    "mode": "NULLABLE",
    "type": "DATETIME",
    "description": "",
    "fields": []
  },
  {
    "name": "proximaFechaPago",
    "mode": "NULLABLE",
    "type": "DATETIME",
    "description": "",
    "fields": []
  },
  {
    "name": "fechaPedidoCancelacion",
    "mode": "NULLABLE",
    "type": "DATETIME",
    "description": "",
    "fields": []
  },
  {
    "name": "tipoProducto2",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "fechaModificacion",
    "mode": "NULLABLE",
    "type": "DATETIME",
    "description": "",
    "fields": []
  }
]

Compras_Update:
[
  {
    "name": "idUsuario",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "idCompra",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "idProducto",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "nombreProducto",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "nombreProductoDisplay",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "tipoProducto",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "fechaCreacion",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "idPlanPago",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "nombrePlanPago",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "nombrePlanPagoDisplay",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "idFrecuencia",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "noDias",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "tipoPeriodo",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "nombreFrecuencia",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "precio",
    "mode": "NULLABLE",
    "type": "FLOAT",
    "description": "",
    "fields": []
  },
  {
    "name": "precioFinal",
    "mode": "NULLABLE",
    "type": "FLOAT",
    "description": "",
    "fields": []
  },
  {
    "name": "idMoneda",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "idDescuento",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "tipoDescuento",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "valorDescuento",
    "mode": "NULLABLE",
    "type": "FLOAT",
    "description": "",
    "fields": []
  },
  {
    "name": "codigosPromocion",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "cantidad",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "fechaInicioEntrega",
    "mode": "NULLABLE",
    "type": "DATETIME",
    "description": "",
    "fields": []
  },
  {
    "name": "fechaInicioSuscripcion",
    "mode": "NULLABLE",
    "type": "DATETIME",
    "description": "",
    "fields": []
  },
  {
    "name": "fechaFinalSuscripcion",
    "mode": "NULLABLE",
    "type": "DATETIME",
    "description": "",
    "fields": []
  },
  {
    "name": "tipoPago",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "tipoOrden",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "marca",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "canal",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "estado",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "ultimaFechaPago",
    "mode": "NULLABLE",
    "type": "DATETIME",
    "description": "",
    "fields": []
  },
  {
    "name": "proximaFechaPago",
    "mode": "NULLABLE",
    "type": "DATETIME",
    "description": "",
    "fields": []
  },
  {
    "name": "fechaPedidoCancelacion",
    "mode": "NULLABLE",
    "type": "DATETIME",
    "description": "",
    "fields": []
  },
  {
    "name": "tipoProducto2",
    "mode": "NULLABLE",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "fechaModificacion",
    "mode": "NULLABLE",
    "type": "DATETIME",
    "description": "",
    "fields": []
  }
]

UsuariosEvolok:
[
  {
    "name": "userid",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "fechaCreacion",
    "mode": "",
    "type": "DATETIME",
    "description": "",
    "fields": []
  },
  {
    "name": "fechaModificacion",
    "mode": "",
    "type": "DATETIME",
    "description": "",
    "fields": []
  },
  {
    "name": "marca",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "dni",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "fechaNacimiento",
    "mode": "",
    "type": "DATE",
    "description": "",
    "fields": []
  },
  {
    "name": "correo",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "estadoCivil",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "nombre",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "apellido",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "genero",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "nivelEducativo",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "telefono",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "profesion",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "compra",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "pais",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "ciudad",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "paisPerfil",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "direccion",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "estado",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "ultimaSesion",
    "mode": "",
    "type": "DATETIME",
    "description": "",
    "fields": []
  },
  {
    "name": "canal",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "suscripcionActiva",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "la_prensa",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "el_heraldo",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "tandc",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "mauticId",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "newsletter_amiga",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "newsletter_deportes",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "newsletter_medicina",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "newsletter_saber",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  }
]

UsuariosEvolok_Update:
[
  {
    "name": "userid",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "fechaCreacion",
    "mode": "",
    "type": "DATETIME",
    "description": "",
    "fields": []
  },
  {
    "name": "fechaModificacion",
    "mode": "",
    "type": "DATETIME",
    "description": "",
    "fields": []
  },
  {
    "name": "marca",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "dni",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "fechaNacimiento",
    "mode": "",
    "type": "DATE",
    "description": "",
    "fields": []
  },
  {
    "name": "correo",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "estadoCivil",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "nombre",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "apellido",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "genero",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "nivelEducativo",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "telefono",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "profesion",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "compra",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "pais",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "ciudad",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "paisPerfil",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "direccion",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "estado",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "ultimaSesion",
    "mode": "",
    "type": "DATETIME",
    "description": "",
    "fields": []
  },
  {
    "name": "canal",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "suscripcionActiva",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "la_prensa",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "el_heraldo",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "tandc",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "mauticId",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "newsletter_amiga",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "newsletter_deportes",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "newsletter_medicina",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  },
  {
    "name": "newsletter_saber",
    "mode": "",
    "type": "STRING",
    "description": "",
    "fields": []
  }
]	

Vistas:

vta_usuariosEvolok:
SELECT
    userid,
    fechaCreacion,
    fechaModificacion,
    marca,
    dni,
    fechaNacimiento,
    correo,
    estadoCivil,
    nombre,
    apellido,
    genero,
    nivelEducativo,
    telefono,
    profesion,
    compra,
    pais,
    ciudad,
    paisPerfil,
    direccion,
    estado,
    ultimaSesion,
    canal,
    suscripcionActiva,
    la_prensa,
    el_heraldo,
    tandc,
    mauticId,
    newsletter_amiga,
    newsletter_deportes,
    newsletter_medicina,
    newsletter_saber
FROM (
    SELECT
        *,
        ROW_NUMBER() OVER (
            PARTITION BY userid
            ORDER BY fechaModificacion DESC
        ) AS _rank
    FROM (
        -- Estado base del usuario
        SELECT * FROM `admanagerapiaccess-382213.UsuariosOPSA.UsuariosEvolok`

        UNION ALL

        -- Estados posteriores del usuario
        SELECT * FROM `admanagerapiaccess-382213.UsuariosOPSA.UsuariosEvolok_Update`
    )
)
WHERE _rank = 1

SELECT *
FROM (
    SELECT
        *,
        ROW_NUMBER() OVER (
            PARTITION BY idCompra
            ORDER BY fechaModificacion DESC
        ) AS rn
    FROM (
        SELECT * FROM `UsuariosOPSA.Compras`
        UNION ALL
        SELECT * FROM `UsuariosOPSA.Compras_Update`
    )
)
WHERE rn = 1